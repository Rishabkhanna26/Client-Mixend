{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///var/www/html/mex-end/app/leads/page.jsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBullseye, faMagnifyingGlass } from '@fortawesome/free-solid-svg-icons';\n\nexport default function LeadsPage() {\n  const [requirements, setRequirements] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [search, setSearch] = useState('');\n  const [filterStatus, setFilterStatus] = useState('all');\n  const [updatingId, setUpdatingId] = useState(null);\n\n  useEffect(() => {\n    fetchRequirements();\n  }, []);\n\n  async function fetchRequirements() {\n    try {\n      const response = await fetch('/api/requirements', { credentials: 'include' });\n      const data = await response.json();\n      setRequirements(data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch requirements:', error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function updateStatus(requirementId, status) {\n    const previous = requirements;\n    setUpdatingId(requirementId);\n    setRequirements((prev) =>\n      prev.map((req) => (req.id === requirementId ? { ...req, status } : req))\n    );\n\n    try {\n      const response = await fetch(`/api/requirements/${requirementId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ status }),\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to update status');\n      }\n      setRequirements((prev) =>\n        prev.map((req) => (req.id === requirementId ? data.data : req))\n      );\n    } catch (error) {\n      console.error('Failed to update status:', error);\n      setRequirements(previous);\n    } finally {\n      setUpdatingId(null);\n    }\n  }\n\n  const filteredRequirements = requirements.filter(req => {\n    const matchesSearch = req.name?.toLowerCase().includes(search.toLowerCase()) ||\n      req.requirement_text?.toLowerCase().includes(search.toLowerCase());\n    const matchesStatus = filterStatus === 'all' || req.status === filterStatus;\n    return matchesSearch && matchesStatus;\n  });\n\n  const getStatusColor = (status) => {\n    switch(status) {\n      case 'pending': return 'bg-yellow-100 text-yellow-800';\n      case 'in_progress': return 'bg-blue-100 text-blue-800';\n      case 'completed': return 'bg-green-100 text-green-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-aa-orange mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading leads...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-4 flex items-center gap-2\">\n          <FontAwesomeIcon icon={faBullseye} className=\"text-aa-orange\" style={{ fontSize: 32 }} />\n          Leads\n        </h1>\n        \n        <div className=\"flex gap-3 mb-4\">\n          <div className=\"flex-1 relative\">\n            <FontAwesomeIcon\n              icon={faMagnifyingGlass}\n              className=\"absolute left-3 top-3 text-gray-400\"\n              style={{ fontSize: 20 }}\n            />\n            <input\n              type=\"text\"\n              placeholder=\"Search by name or requirement...\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-aa-orange\"\n            />\n          </div>\n          <select\n            value={filterStatus}\n            onChange={(e) => setFilterStatus(e.target.value)}\n            className=\"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-aa-orange\"\n          >\n            <option value=\"all\">All Status</option>\n            <option value=\"pending\">Pending</option>\n            <option value=\"in_progress\">In Progress</option>\n            <option value=\"completed\">Completed</option>\n          </select>\n        </div>\n      </div>\n\n      <div className=\"space-y-3\">\n        {filteredRequirements.length === 0 ? (\n          <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\n            <FontAwesomeIcon icon={faBullseye} className=\"mx-auto text-gray-400 mb-2\" style={{ fontSize: 48 }} />\n            <p className=\"text-gray-500\">No leads found</p>\n          </div>\n        ) : (\n          filteredRequirements.map((req) => (\n            <div\n              key={req.id}\n              className=\"bg-white p-4 rounded-lg border border-gray-200 hover:shadow-md transition\"\n            >\n              <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"font-bold text-lg text-gray-900\">{req.name}</h3>\n                <div className=\"flex items-center gap-2\">\n                  <span className={`px-3 py-1 rounded-full text-xs font-semibold ${getStatusColor(req.status)}`}>\n                    {req.status.replace('_', ' ').toUpperCase()}\n                  </span>\n                  <select\n                    value={req.status}\n                    onChange={(e) => updateStatus(req.id, e.target.value)}\n                    className=\"px-2 py-1 border border-gray-300 rounded-md text-xs focus:outline-none focus:ring-2 focus:ring-aa-orange\"\n                    disabled={updatingId === req.id}\n                    aria-label=\"Update lead status\"\n                  >\n                    <option value=\"pending\">Pending</option>\n                    <option value=\"in_progress\">In Progress</option>\n                    <option value=\"completed\">Completed</option>\n                  </select>\n                </div>\n              </div>\n              <p className=\"text-gray-700 mb-3\">{req.requirement_text}</p>\n              <div className=\"flex justify-between items-center text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Category: </span>\n                  <span className=\"font-semibold text-gray-700\">{req.category}</span>\n                </div>\n                <span className=\"text-gray-500 text-xs\">\n                  {new Date(req.created_at).toLocaleDateString()}\n                </span>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}