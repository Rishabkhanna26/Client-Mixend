{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///var/www/html/mex-end/app/components/common/Modal.jsx"],"sourcesContent":["export default function Modal({ isOpen, onClose, title, children, size = 'md' }) {\n  if (!isOpen) return null;\n\n  const sizes = {\n    sm: 'max-w-md',\n    md: 'max-w-2xl',\n    lg: 'max-w-4xl',\n    xl: 'max-w-6xl',\n  };\n\n  return (\n    <div \n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\"\n      onClick={onClose}\n      data-testid=\"modal-overlay\"\n    >\n      <div \n        className={`bg-white rounded-xl shadow-2xl ${sizes[size]} w-full mx-4 max-h-[90vh] overflow-y-auto`}\n        onClick={(e) => e.stopPropagation()}\n        data-testid=\"modal-content\"\n      >\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <h2 className=\"text-2xl font-bold text-aa-dark-blue\">{title}</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 text-2xl\"\n            data-testid=\"modal-close-btn\"\n          >\n            ×\n          </button>\n        </div>\n        <div className=\"p-6\">\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAe,SAAS,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,IAAI,EAAE;IAC7E,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,QAAQ;QACZ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,6LAAC;QACC,WAAU;QACV,SAAS;QACT,eAAY;kBAEZ,cAAA,6LAAC;YACC,WAAW,CAAC,+BAA+B,EAAE,KAAK,CAAC,KAAK,CAAC,yCAAyC,CAAC;YACnG,SAAS,CAAC,IAAM,EAAE,eAAe;YACjC,eAAY;;8BAEZ,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,eAAY;sCACb;;;;;;;;;;;;8BAIH,6LAAC;oBAAI,WAAU;8BACZ;;;;;;;;;;;;;;;;;AAKX;KArCwB"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///var/www/html/mex-end/app/contacts/page.jsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUsers, faMagnifyingGlass, faPhone, faEnvelope } from '@fortawesome/free-solid-svg-icons';\nimport Modal from '../components/common/Modal.jsx';\n\nexport default function ContactsPage() {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [search, setSearch] = useState('');\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [modalLoading, setModalLoading] = useState(false);\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  async function fetchUsers() {\n    try {\n      const response = await fetch('/api/users');\n      const data = await response.json();\n      setUsers(data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch users:', error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const openDetails = async (user) => {\n    setSelectedUser(user);\n    setModalOpen(true);\n    setMessages([]);\n    setModalLoading(true);\n    try {\n      const response = await fetch(`/api/users/${user.id}/messages`);\n      const data = await response.json();\n      setMessages(data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch user messages:', error);\n    } finally {\n      setModalLoading(false);\n    }\n  };\n\n  const filteredUsers = users.filter(user =>\n    user.name?.toLowerCase().includes(search.toLowerCase()) ||\n    user.phone?.includes(search) ||\n    user.email?.toLowerCase().includes(search.toLowerCase())\n  );\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-aa-orange mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading contacts...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-4 flex items-center gap-2\">\n          <FontAwesomeIcon icon={faUsers} className=\"text-aa-orange\" style={{ fontSize: 32 }} />\n          Contacts\n        </h1>\n        \n        <div className=\"relative\">\n          <FontAwesomeIcon\n            icon={faMagnifyingGlass}\n            className=\"absolute left-3 top-3 text-gray-400\"\n            style={{ fontSize: 20 }}\n          />\n          <input\n            type=\"text\"\n            placeholder=\"Search by name, phone, or email...\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-aa-orange\"\n          />\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {filteredUsers.length === 0 ? (\n          <div className=\"col-span-full text-center py-12 bg-gray-50 rounded-lg\">\n            <FontAwesomeIcon icon={faUsers} className=\"mx-auto text-gray-400 mb-2\" style={{ fontSize: 48 }} />\n            <p className=\"text-gray-500\">No contacts found</p>\n          </div>\n        ) : (\n          filteredUsers.map((user) => (\n            <div\n              key={user.id}\n              className=\"bg-white p-4 rounded-lg border border-gray-200 hover:shadow-lg transition\"\n            >\n              <h3 className=\"font-bold text-lg text-gray-900 mb-2\">{user.name}</h3>\n              <div className=\"space-y-2 text-sm text-gray-600\">\n                <div className=\"flex items-center gap-2\">\n                  <FontAwesomeIcon icon={faPhone} className=\"text-aa-orange\" style={{ fontSize: 16 }} />\n                  <span>{user.phone}</span>\n                </div>\n                {user.email && (\n                  <div className=\"flex items-center gap-2\">\n                    <FontAwesomeIcon icon={faEnvelope} className=\"text-aa-orange\" style={{ fontSize: 16 }} />\n                    <span>{user.email}</span>\n                  </div>\n                )}\n                <div className=\"mt-3 pt-3 border-t\">\n                  <p className=\"text-xs text-gray-500\">Assigned to: <span className=\"font-semibold\">{user.admin_name}</span></p>\n                </div>\n              </div>\n              <div className=\"mt-3 pt-3 border-t flex gap-2\">\n                <button className=\"flex-1 px-3 py-1 bg-aa-orange text-white rounded text-sm font-semibold hover:bg-opacity-90 transition\">\n                  Message\n                </button>\n                <button\n                  className=\"flex-1 px-3 py-1 border border-aa-orange text-aa-orange rounded text-sm font-semibold hover:bg-aa-orange hover:text-white transition\"\n                  onClick={() => openDetails(user)}\n                >\n                  View\n                </button>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      <Modal\n        isOpen={modalOpen}\n        onClose={() => setModalOpen(false)}\n        title=\"Contact Details\"\n        size=\"md\"\n      >\n        {!selectedUser ? (\n          <p className=\"text-aa-gray\">No contact selected.</p>\n        ) : (\n          <div className=\"space-y-5\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-14 h-14 rounded-full bg-aa-orange/10 flex items-center justify-center\">\n                <span className=\"text-lg font-semibold text-aa-orange\">\n                  {selectedUser.name?.charAt(0) || 'U'}\n                </span>\n              </div>\n              <div>\n                <p className=\"text-xl font-bold text-aa-dark-blue\">{selectedUser.name || 'Unknown'}</p>\n                <p className=\"text-sm text-aa-gray\">{selectedUser.admin_name ? `Assigned to ${selectedUser.admin_name}` : 'Unassigned'}</p>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div className=\"p-4 border border-gray-200 rounded-lg\">\n                <p className=\"text-xs text-aa-gray uppercase mb-1\">Phone</p>\n                <p className=\"font-semibold text-aa-text-dark\">{selectedUser.phone || '—'}</p>\n              </div>\n              <div className=\"p-4 border border-gray-200 rounded-lg\">\n                <p className=\"text-xs text-aa-gray uppercase mb-1\">Email</p>\n                <p className=\"font-semibold text-aa-text-dark\">{selectedUser.email || '—'}</p>\n              </div>\n              <div className=\"p-4 border border-gray-200 rounded-lg\">\n                <p className=\"text-xs text-aa-gray uppercase mb-1\">Created At</p>\n                <p className=\"font-semibold text-aa-text-dark\">\n                  {selectedUser.created_at ? new Date(selectedUser.created_at).toLocaleString() : '—'}\n                </p>\n              </div>\n              <div className=\"p-4 border border-gray-200 rounded-lg\">\n                <p className=\"text-xs text-aa-gray uppercase mb-1\">Updated At</p>\n                <p className=\"font-semibold text-aa-text-dark\">\n                  {selectedUser.updated_at ? new Date(selectedUser.updated_at).toLocaleString() : '—'}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"border-t pt-4\">\n              <h3 className=\"text-lg font-semibold text-aa-dark-blue mb-3\">Message Details</h3>\n              {modalLoading ? (\n                <p className=\"text-aa-gray\">Loading messages...</p>\n              ) : messages.length === 0 ? (\n                <p className=\"text-aa-gray\">No messages found for this contact.</p>\n              ) : (\n                <div className=\"space-y-3\">\n                  {(() => {\n                    const latest = messages[0];\n                    return (\n                      <div className=\"p-4 border border-gray-200 rounded-lg\">\n                        <p className=\"text-xs text-aa-gray uppercase mb-1\">Reason / Latest Message</p>\n                        <p className=\"font-semibold text-aa-text-dark mb-2\">{latest.message_text}</p>\n                        <div className=\"flex flex-wrap gap-2 text-sm\">\n                          <span className=\"px-2 py-1 rounded bg-gray-100 text-aa-gray\">\n                            Status: {latest.status || '—'}\n                          </span>\n                          <span className=\"px-2 py-1 rounded bg-gray-100 text-aa-gray\">\n                            Type: {latest.message_type || '—'}\n                          </span>\n                          <span className=\"px-2 py-1 rounded bg-gray-100 text-aa-gray\">\n                            Date: {latest.created_at ? new Date(latest.created_at).toLocaleString() : '—'}\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })()}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}